<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Î¨¥Îìú Ìä∏Î¶Ω - Îß§Ïπ≠ Ï†ïÎ≥¥</title>
    <link rel="stylesheet" th:href="@{/css/mypage/my-matching.css}">
    <script th:src="@{/js/mypage/my-matching.js}"></script>
    <link rel=" stylesheet" th:href="@{/css/fix/header.css}">
    <link rel="stylesheet" th:href="@{/css/fix/footer.css}">
    <link rel="stylesheet" th:href="@{/css/fix/header-after.css}">
</head>
<body>
<!-- Î°úÍ∑∏Ïù∏ ÏÉÅÌÉúÏóê Îî∞Î•∏ Ï°∞Í±¥Î∂Ä Ìó§Îçî Î†åÎçîÎßÅ -->
<div th:if="${isLoggedIn}">
    <!-- Î°úÍ∑∏Ïù∏Îêú ÏÇ¨Ïö©ÏûêÏö© Ìó§Îçî -->
    <th:block th:replace="~{fix/header-after-login :: header}"></th:block>
</div>
<div th:unless="${isLoggedIn}">
    <!-- Î°úÍ∑∏Ïù∏ ÏïàÎêú ÏÇ¨Ïö©ÏûêÏö© Ìó§Îçî -->
    <th:block th:replace="~{fix/header :: header}"></th:block>
</div>
<div id="notification-container"></div>
<div>
    <div class="wrap">
        <div class="page">
            <div class="page-inner">
                <aside class="user-settings-nav">
                    <div class="account-settings">Í≥ÑÏ†ï ÏÑ§Ï†ï</div>
                    <hr orientation="horizontal" class="horizontal-line">
                    <a class="my_profile active" th:href="@{/mypage/my-profile}">ÎÇ¥ Ï†ïÎ≥¥</a>
                    <a class="my_matching active" th:href="@{/mypage/my-matching}">Îß§Ïπ≠ Ï†ïÎ≥¥</a>
                    <a class="join_requests active" th:href="@{/mypage/join-requests}">
                        Î∞© ÏûÖÏû• ÏöîÏ≤≠ Í¥ÄÎ¶¨
                        <span class="notification-badge" id="join-requests-badge" style="display: none;">0</span>
                    </a>
                    <a class="my_reviews active" th:href="@{/mypage/my-reviews}">ÎÇ¥Í∞Ä Ïì¥ ÌõÑÍ∏∞</a>
                    <a class="my_tourist_attraction_wishlist active" th:href="@{/mypage/my-tourist-attraction-wishlist}">Í¥ÄÍ¥ëÏßÄ Ï∞ú Î™©Î°ù</a>
                    <a class="change_password active" th:href="@{/mypage/change-password}">ÎπÑÎ∞ÄÎ≤àÌò∏ Î≥ÄÍ≤Ω Ï†ïÎ≥¥</a>
                    <a class="alarm active" th:href="@{/mypage/alarm}">ÏïåÎ¶º ÏÑ§Ï†ï</a>
                </aside>
                <main class="mypage_info">
                    <div class="total-wrapper">
                        <h1 class="info-title">Îß§Ïπ≠ Ï†ïÎ≥¥</h1>
                        <div class="main-wrapper">
                            <div class="tab-navigation">
                                <button class="tab-btn" th:classappend="${activeTab == 'received' ? 'active' : ''}" data-tab="received">ÎÇ¥Í∞Ä ÏûÖÏû•Ìïú Î∞©</button>
                                <button class="tab-btn" th:classappend="${activeTab == 'created' ? 'active' : ''}" data-tab="created">ÎÇ¥Í∞Ä ÎßåÎì† Î∞©</button>
                            </div>

                            <!-- üî• ÎÇ¥Í∞Ä ÏûÖÏû•Ìïú Î∞© ÌÉ≠ (Thymeleaf Î†åÎçîÎßÅ) -->
                            <section class="tab-content" th:classappend="${activeTab == 'received' ? 'active' : ''}" id="received-tab">
                                <div class="matching-list-wrapper">

                                    <!-- üéØ ÏûÖÏû•Ìïú Î∞©Ïù¥ ÏûàÎäî Í≤ΩÏö∞ -->
                                    <div th:if="${hasJoinedRooms}">
                                        <div th:each="room : ${joinedRooms}" class="matching-item" th:attr="data-room-id=${room.roomId}">
                                            <div class="matching-item-inner">
                                                <div class="matching-info-section">
                                                    <div class="matching-image-wrapper">
                                                        <img src="/image/fix/moodtrip.png" th:alt="${room.roomName}" class="matching-image">
                                                    </div>
                                                    <div class="matching-details">
                                                        <h3 class="matching-title" th:text="${room.roomName}">Î∞© Ï†úÎ™©</h3>
                                                        <div class="matching-meta">
                                                                <span class="host-badge" th:classappend="${room.myRole == 'LEADER' ? 'host' : ''}"
                                                                      th:text="${room.myRole == 'LEADER' ? 'Î∞©Ïû•' : 'Î©§Î≤Ñ'}">Ïó≠Ìï†</span>
                                                            <span class="separator">|</span>
                                                            <span class="host-name" th:text="${room.creatorNickname ?: 'Ïïå Ïàò ÏóÜÏùå'}">Î∞©Ïû•Î™Ö</span>
                                                        </div>
                                                        <div class="matching-meta-secondary">
                                                            <span class="category" th:text="${room.destinationCategory ?: 'Í∏∞ÌÉÄ'}">Ïπ¥ÌÖåÍ≥†Î¶¨</span>
                                                            <span class="separator">|</span>
                                                            <span class="tags">Ïó¨Ìñâ</span>
                                                            <span class="location-tag" th:text="${room.destinationName ?: ''}">Î™©Ï†ÅÏßÄ</span>
                                                        </div>
                                                        <p class="matching-description"
                                                           th:text="${room.roomDescription ?: 'Ï¶êÍ±∞Ïö¥ Ïó¨ÌñâÏùÑ Ìï®Íªò ÌïòÏã§ Î∂ÑÎì§ÏùÑ Ï∞æÏäµÎãàÎã§!'}">ÏÑ§Î™Ö</p>
                                                        <div class="matching-tags">
                                                                <span th:each="emotion : ${room.emotions}"
                                                                      class="tag" th:text="'#' + ${emotion}">#Í∞êÏ†ïÌÉúÍ∑∏</span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- üî• ÌïµÏã¨: ÏÉÅÌÉú Î∞è Î≤ÑÌäº ÏÑπÏÖò -->
                                                <div class="matching-status-section">
                                                    <div class="status-info">
                                                        <div class="participants-info">
                                                            <span class="label">Î©§Î≤Ñ Ïù∏Ïõê</span>
                                                            <span class="count" th:text="${room.currentCount} + ' / ' + ${room.maxCount}">0 / 0</span>
                                                        </div>
                                                        <div class="travel-date">
                                                            <span class="label">Ïó¨Ìñâ ÎÇ†Ïßú</span>
                                                            <span class="date">
                                                                <span th:text="${#temporals.format(room.travelStartDate, 'yy/MM/dd')}">ÏãúÏûëÏùº</span>
                                                                ~
                                                                <span th:text="${#temporals.format(room.travelEndDate, 'yy/MM/dd')}">Ï¢ÖÎ£åÏùº</span>
                                                            </span>
                                                        </div>
                                                    </div>
                                                    <!-- üî• Ï§ëÏöî: Î≤ÑÌäº ÏÑπÏÖò -->
                                                    <div class="action-buttons">
                                                        <button class="btn-chat" th:attr="data-room-id=${room.roomId}">Ïä§ÏºÄÏ§Ñ ÏßúÎü¨ Í∞ÄÍ∏∞</button>
                                                        <button class="btn-exit-room" data-room-type="participant"
                                                                th:attr="data-room-id=${room.roomId}">Î∞© ÎÇòÍ∞ÄÍ∏∞</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- üéØ ÏûÖÏû•Ìïú Î∞©Ïù¥ ÏóÜÎäî Í≤ΩÏö∞ -->
                                    <div th:unless="${hasJoinedRooms}" class="empty-state">
                                        <div style="text-align: center; padding: 4rem 2rem; color: #64748b;">
                                            <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" style="margin-bottom: 1rem; opacity: 0.5;">
                                                <circle cx="12" cy="12" r="10"></circle>
                                                <path d="M12 6v6l4 2"></path>
                                            </svg>
                                            <h3 style="margin-bottom: 0.5rem; color: #475569;">Ï∞∏Ïó¨ Ï§ëÏù∏ Îß§Ïπ≠Ïù¥ ÏóÜÏäµÎãàÎã§</h3>
                                            <p style="color: #64748b;">ÏÉàÎ°úÏö¥ Ïó¨Ìñâ Îß§Ïπ≠ÏùÑ Ï∞æÏïÑÎ≥¥ÏÑ∏Ïöî!</p>
                                        </div>
                                    </div>
                                </div>
                            </section>

                            <!-- üî• ÎÇ¥Í∞Ä ÎßåÎì† Î∞© ÌÉ≠ -->
                            <section class="tab-content" th:classappend="${activeTab == 'created' ? 'active' : ''}" id="created-tab">
                                <div class="matching-list-wrapper">

                                    <!-- üéØ ÏÉùÏÑ±Ìïú Î∞©Ïù¥ ÏûàÎäî Í≤ΩÏö∞ -->
                                    <div th:if="${hasCreatedRooms}">
                                        <div th:each="room : ${createdRooms}" class="matching-item" th:attr="data-room-id=${room.roomId}">
                                            <div class="matching-item-inner">
                                                <div class="matching-info-section">
                                                    <div class="matching-image-wrapper">
                                                        <img src="/image/fix/moodtrip.png" th:alt="${room.roomName}" class="matching-image">
                                                    </div>
                                                    <div class="matching-details">
                                                        <h3 class="matching-title" th:text="${room.roomName}">Î∞© Ï†úÎ™©</h3>
                                                        <div class="matching-meta">
                                                            <span class="host-badge host">Î∞©Ïû•</span>
                                                            <span class="separator">|</span>
                                                            <span class="host-name" th:text="${currentMember.nickname}">ÎÇò</span>
                                                        </div>
                                                        <div class="matching-meta-secondary">
                                                            <span class="category" th:text="${room.destinationCategory ?: 'Í∏∞ÌÉÄ'}">Ïπ¥ÌÖåÍ≥†Î¶¨</span>
                                                            <span class="separator">|</span>
                                                            <span class="tags">Ïó¨Ìñâ</span>
                                                            <span class="location-tag" th:text="${room.destinationName ?: ''}">Î™©Ï†ÅÏßÄ</span>
                                                        </div>
                                                        <p class="matching-description"
                                                           th:text="${room.roomDescription ?: 'Ï¶êÍ±∞Ïö¥ Ïó¨ÌñâÏùÑ Ìï®Íªò ÌïòÏã§ Î∂ÑÎì§ÏùÑ Ï∞æÏäµÎãàÎã§!'}">ÏÑ§Î™Ö</p>
                                                        <div class="matching-tags">
                                                                <span th:each="emotion : ${room.emotions}"
                                                                      class="tag" th:text="'#' + ${emotion}">#Í∞êÏ†ïÌÉúÍ∑∏</span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- üî• ÌïµÏã¨: Î∞©Ïû•Ïö© Î≤ÑÌäºÎì§ -->
                                                <div class="matching-status-section">
                                                    <div class="status-info">
                                                        <div class="participants-info">
                                                            <span class="label">Î©§Î≤Ñ Ïù∏Ïõê</span>
                                                            <span class="count" th:text="${room.currentCount} + ' / ' + ${room.maxCount}">0 / 0</span>
                                                        </div>
                                                        <div class="travel-date">
                                                            <span class="label">Ïó¨Ìñâ ÎÇ†Ïßú</span>
                                                            <span class="date">
                                                            <span th:text="${#temporals.format(room.travelStartDate, 'yy/MM/dd')}">ÏãúÏûëÏùº</span>
                                                                ~
                                                            <span th:text="${#temporals.format(room.travelEndDate, 'yy/MM/dd')}">Ï¢ÖÎ£åÏùº</span>
                                                        </span>
                                                        </div>
                                                        <div class="join-requests-info">
                                                            <span class="label">ÎåÄÍ∏∞ Ï§ëÏù∏ ÏöîÏ≤≠</span>
                                                            <span class="count pending-requests" th:attr="data-room-id=${room.roomId}">0Í±¥</span>
                                                        </div>
                                                    </div>
                                                    <!-- üî• Ï§ëÏöî: Î∞©Ïû•Ïö© Î≤ÑÌäºÎì§ -->
                                                    <div class="action-buttons">
                                                        <button class="btn-chat" th:attr="data-room-id=${room.roomId}">Ïä§ÏºÄÏ§Ñ ÏßúÎü¨ Í∞ÄÍ∏∞</button>
                                                        <button class="btn-manage-requests" th:attr="data-room-id=${room.roomId}" disabled>ÏûÖÏû• ÏöîÏ≤≠ Í¥ÄÎ¶¨</button>
                                                        <button class="btn-delete-room" data-room-type="host"
                                                                th:attr="data-room-id=${room.roomId}">Î∞© ÏÇ≠Ï†úÌïòÍ∏∞</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- üéØ ÏÉùÏÑ±Ìïú Î∞©Ïù¥ ÏóÜÎäî Í≤ΩÏö∞ -->
                                    <div th:unless="${hasCreatedRooms}" class="empty-state">
                                        <div style="text-align: center; padding: 4rem 2rem; color: #64748b;">
                                            <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" style="margin-bottom: 1rem; opacity: 0.5;">
                                                <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"></path>
                                            </svg>
                                            <h3 style="margin-bottom: 0.5rem; color: #475569;">ÏÉùÏÑ±Ìïú Îß§Ïπ≠Ïù¥ ÏóÜÏäµÎãàÎã§</h3>
                                            <p style="color: #64748b;">ÏÉàÎ°úÏö¥ Ïó¨Ìñâ Îß§Ïπ≠ÏùÑ ÎßåÎì§Ïñ¥Î≥¥ÏÑ∏Ïöî!</p>
                                        </div>
                                    </div>
                                </div>
                            </section>
                        </div>
                    </div>
                </main>
            </div>
        </div>
    </div>
</div>

<!-- üî• Î™®Îã¨Îì§ -->
<!-- Î∞© ÎÇòÍ∞ÄÍ∏∞ ÌôïÏù∏ Î™®Îã¨ -->
<div id="exitRoomModal" class="modal" style="display: none;">
    <div class="modal-content">
        <div class="modal-header">
            <h3>Î∞© ÎÇòÍ∞ÄÍ∏∞ ÌôïÏù∏</h3>
            <button class="modal-close">&times;</button>
        </div>
        <div class="modal-body">
            <p>Ï†ïÎßêÎ°ú Ïù¥ Î∞©ÏùÑ ÎÇòÍ∞ÄÏãúÍ≤†ÏäµÎãàÍπå?</p>
            <p class="modal-warning">Î∞©ÏùÑ ÎÇòÍ∞ÄÎ©¥ Îã§Ïãú Ï∞∏Ïó¨ÌïòÎ†§Î©¥ Î∞©Ïû•Ïùò ÏäπÏù∏Ïù¥ ÌïÑÏöîÌï©ÎãàÎã§.</p>
        </div>
        <div class="modal-footer">
            <button class="btn-cancel">Ï∑®ÏÜå</button>
            <button class="btn-confirm">Î∞© ÎÇòÍ∞ÄÍ∏∞</button>
        </div>
    </div>
</div>

<!-- Î∞© ÏÇ≠Ï†ú ÌôïÏù∏ Î™®Îã¨ -->
<div id="deleteRoomModal" class="modal" style="display: none;">
    <div class="modal-content">
        <div class="modal-header">
            <h3>Î∞© ÏÇ≠Ï†ú ÌôïÏù∏</h3>
            <button class="modal-close">&times;</button>
        </div>
        <div class="modal-body">
            <p>Ï†ïÎßêÎ°ú Ïù¥ Î∞©ÏùÑ ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?</p>
            <p class="modal-warning">Î∞©ÏùÑ ÏÇ≠Ï†úÌïòÎ©¥ Î™®Îì† Ï∞∏Ïó¨ÏûêÍ∞Ä ÎÇ¥Î≥¥ÎÇ¥ÏßÄÎ©∞, Ï±ÑÌåÖ Í∏∞Î°ùÎèÑ ÏÇ≠Ï†úÎê©ÎãàÎã§.</p>
            <p class="modal-danger">Ïù¥ ÏûëÏóÖÏùÄ ÎêòÎèåÎ¶¥ Ïàò ÏóÜÏäµÎãàÎã§.</p>
        </div>
        <div class="modal-footer">
            <button class="btn-cancel">Ï∑®ÏÜå</button>
            <button class="btn-confirm btn-danger">Î∞© ÏÇ≠Ï†úÌïòÍ∏∞</button>
        </div>
    </div>
</div>

<!-- ÏûÖÏû• ÏöîÏ≤≠ Í¥ÄÎ¶¨ Î™®Îã¨ -->
<div id="manageRequestsModal" class="modal" style="display: none;">
    <div class="modal-content modal-large">
        <div class="modal-header">
            <h3>ÏûÖÏû• ÏöîÏ≤≠ Í¥ÄÎ¶¨</h3>
            <button class="modal-close">&times;</button>
        </div>
        <div class="modal-body">
            <div class="requests-list">
                <div class="empty-requests">
                    <p>ÎåÄÍ∏∞ Ï§ëÏù∏ ÏöîÏ≤≠Ïù¥ ÏóÜÏäµÎãàÎã§.</p>
                </div>
            </div>
        </div>
        <div class="modal-footer">
            <button class="btn-cancel">Îã´Í∏∞</button>
        </div>
    </div>
</div>
</div>
</main>
</div>
</div>
</div>
</div>
<!-- Ìë∏ÌÑ∞ Ìè¨Ìï® -->
<th:block th:replace="~{fix/footer :: footer}"></th:block>

<script th:src="@{/js/fix/header.js}"></script>
<script th:src="@{/js/fix/header-after.js}"></script>
</body>
</html>