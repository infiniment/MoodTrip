<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>무드 트립 - 관광지 찜 목록</title>
    <!-- CSS 경로는 static 폴더를 기준으로 합니다. -->
    <link rel="stylesheet" href="/css/mypage/my-tourist-attraction-wishlist.css">

</head>
<body>
<div>
    <div class="wrap">
        <div class="page">
            <div class="page-inner">
                <!-- ========== 사이드바 ========== -->
                <aside class="user-settings-nav">
                    <div class="account-settings">계정 설정</div>
                    <hr orientation="horizontal" class="horizontal-line">
                    <!-- th:href를 사용하여 동적 URL 생성 및 th:classappend로 현재 페이지 활성화 -->
                    <a class="my_profile" th:href="@{/mypage/my-profile}">내 정보</a>
                    <a class="my_matching" th:href="@{/mypage/my-matching}">매칭 정보</a>
                    <a class="join_requests" th:href="@{/mypage/join-requests}">
                        방 입장 요청 관리
                        <span class="notification-badge" id="join-requests-badge" style="display: none;">0</span>
                    </a>
                    <a class="my_tourist_attraction_wishlist active" th:href="@{/mypage/my-tourist-attraction-wishlist}">관광지 찜 목록</a>
                    <a class="change_password" th:href="@{/mypage/change-password}">비밀번호 변경 정보</a>
                </aside>

                <!-- ========== 메인 콘텐츠 ========== -->
                <main class="mypage_info">
                    <div class="total-wrapper">
                        <h1 class="info-title">관광지 찜 목록</h1>

                        <!-- [수정] 찜 목록이 없을 경우 -->
                        <div th:if="${wishlist == null or wishlist.isEmpty()}" class="no-results-message">
                            <p>찜한 여행지가 없습니다. 마음에 드는 여행지를 추가해보세요!</p>
                        </div>

                        <!-- [수정] 찜 목록이 있을 경우에만 그리드를 표시 -->
                        <div class="wishlist-grid" th:unless="${wishlist == null or wishlist.isEmpty()}">

                            <!-- [수정] th:each를 사용해 컨트롤러에서 받은 'wishlist'를 반복 -->
                            <div class="wishlist-card" th:each="attraction : ${wishlist}">
                                <div class="card-image-wrapper">
                                    <a th:href="@{/attractions/{id}(id=${attraction.attractionId})}">
                                        <img th:src="${attraction.firstImage != null && !attraction.firstImage.isEmpty() ? attraction.firstImage : '/image/emotion-search/default-image.png'}"
                                             th:alt="${attraction.title}" class="card-image">
                                    </a>
                                    <button class="heart-button active" th:data-attraction-id="${attraction.attractionId}">
                                        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                            <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
                                        </svg>
                                    </button>
                                </div>
                                <div class="card-content">
                                    <div class="card-meta">
                                        <span class="category" th:text="${attraction.addr1}">위치 정보</span>
                                    </div>
                                    <h3 class="card-title" th:text="${attraction.title}">관광지 이름</h3>
                                    <p class="card-description" th:text="${attraction.description}">여행지에 대한 설명입니다.</p>
                                </div>
                            </div>
                        </div>

                        <!-- [수정] 페이지네이션 (서버에서 Page 객체를 받았다고 가정) -->
                        <!-- [수정] 페이지네이션 (서버에서 Page 객체를 받았다고 가정) -->
                        <div class="pagination-wrapper" th:if="${wishlist != null and wishlist.totalPages > 1}">
                            <nav class="pagination">
                                <!-- 맨 처음, 이전 페이지 버튼 -->
                                <a th:href="@{/mypage/my-tourist-attraction-wishlist(page=0)}" class="page-btn prev" th:classappend="${wishlist.first} ? 'disabled' : ''">&lt;&lt;</a>

                                <!-- [수정된 부분] : th:href를 분리하여 처리 -->
                                <a th:if="${!wishlist.first}" th:href="@{/mypage/my-tourist-attraction-wishlist(page=${wishlist.number - 1})}" class="page-btn prev">&lt;</a>
                                <a th:if="${wishlist.first}" href="#" class="page-btn prev disabled">&lt;</a>

                                <!-- 페이지 번호 버튼 -->
                                <th:block th:each="pageNumber : ${#numbers.sequence(0, wishlist.totalPages - 1)}">
                                    <a th:href="@{/mypage/my-tourist-attraction-wishlist(page=${pageNumber})}"
                                       th:text="${pageNumber + 1}"
                                       class="page-btn"
                                       th:classappend="${pageNumber == wishlist.number} ? 'active' : ''"></a>
                                </th:block>

                                <!-- 다음, 마지막 페이지 버튼 -->
                                <!-- [수정된 부분] : th:href를 분리하여 처리 -->
                                <a th:if="${!wishlist.last}" th:href="@{/mypage/my-tourist-attraction-wishlist(page=${wishlist.number + 1})}" class="page-btn next">&gt;</a>
                                <a th:if="${wishlist.last}" href="#" class="page-btn next disabled">&gt;</a>

                                <a th:href="@{/mypage/my-tourist-attraction-wishlist(page=${wishlist.totalPages - 1})}" class="page-btn next" th:classappend="${wishlist.last} ? 'disabled' : ''">&gt;&gt;</a>
                            </nav>
                        </div>

                    </div>
                </main>
            </div>
        </div>
    </div>
</div>
<!-- JavaScript 경로 수정 -->
<script src="/js/mypage/my-tourist-attraction-wishlist.js"></script>
</body>
</html>
