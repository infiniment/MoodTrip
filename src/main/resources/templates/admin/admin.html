<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>여행 플랫폼 관리자</title>
    <link rel="stylesheet" href="/css/admin/admin.css">

    <link rel="stylesheet" href="/css/admin/adminMapping.css">
    <script src="/js/admin/adminMapping.js" defer></script>
    <meta name="_csrf" th:content="${_csrf?.token}"/>
    <meta name="_csrf_header" th:content="${_csrf?.headerName}"/>
    <!--불안정 수정 ver1-->
<!--    <script>-->
<!--        const matchingMembersData = {-->
<!--        <th:block th:each="matching : ${matchings}">-->
<!--            '<th:block th:text="${matching.roomId}"></th:block>': {-->
<!--            participants: [<th:block th:each="participant : ${matching.participants}">'<th:block th:text="${participant}"></th:block>',</th:block>],-->
<!--            createdAt: '<th:block th:text="${matching.createdAt}"></th:block>'-->
<!--        },-->
<!--        </th:block>-->
<!--        };-->

<!--        console.log("matchingMembersData:", matchingMembersData);-->
<!--    </script>-->
    <!--불안정 수정 ver2-->
    <script th:inline="javascript">
        /*<![CDATA[*/
        const matchingMembersData = {
            /*[# th:each="m, stat : ${matchings}"]*/
            '/*[[${m.roomId}]]*/': {
                // List<String>면 자동으로 JS 배열로 직렬화됨
                participants: /*[[${m.participants}]]*/,
                // 필요 시 포맷팅
                createdAt: '/*[[${#temporals.format(m.createdAt, "yyyy-MM-dd HH:mm:ss")}]]*/'
            }/*[[${stat.last} ? '' : ',' ]]*/
            /*[/]*/
        };

        console.log('matchingMembersData:', matchingMembersData);
        /*]]>*/
    </script>
    <link rel="stylesheet" th:href="@{/css/fix/header.css}">
    <link rel="stylesheet" th:href="@{/css/fix/footer.css}">
    <link rel="stylesheet" th:href="@{/css/fix/header-after.css}">
</head>
<body>
<div th:if="${isLoggedIn}">
    <!-- 로그인된 사용자용 헤더 -->
    <th:block th:replace="~{fix/header-after-login :: header}"></th:block>
</div>
<div th:unless="${isLoggedIn}">
    <!-- 로그인 안된 사용자용 헤더 -->
    <th:block th:replace="~{fix/header :: header}"></th:block>
</div>
    <!-- 관리자 페이지 컨테이너 -->
    <div class="admin-container">
        <!-- 사이드바 -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <h2>Travel Admin</h2>
                <p>관리자 대시보드</p>
            </div>
            <nav class="sidebar-menu">
                <div class="menu-item active" data-menu="dashboard">
                    <span class="menu-icon">📊</span>
                    <span class="menu-text">대시보드</span>
                </div>
                <div class="menu-item" data-menu="users">
                    <span class="menu-icon">👥</span>
                    <span class="menu-text">회원 관리</span>
                </div>
<!--                <div class="menu-item" data-menu="content">-->
<!--                    <span class="menu-icon">📝</span>-->
<!--                    <span class="menu-text">콘텐츠 관리</span>-->
<!--                </div>-->
                <div class="menu-item" data-menu="matching">
                    <span class="menu-icon">🤝</span>
                    <span class="menu-text">매칭 관리</span>
                </div>
                <div class="menu-item" data-menu="locations">
                    <span class="menu-icon">📍</span>
                    <span class="menu-text">관광지 관리</span>
                </div>
                <div class="menu-item" data-menu="reports">
                    <span class="menu-icon">⚠️</span>
                    <span class="menu-text">신고 관리</span>
                </div>
                <div class="menu-item" data-menu="notices">
                    <span class="menu-icon">📢</span>
                    <span class="menu-text">공지사항</span>
                </div>
                <div class="menu-item" data-menu="faq">
                    <span class="menu-icon">❓</span>
                    <span class="menu-text">FAQ 관리</span>
                </div>
                <div class="menu-item" data-menu="settings">
                    <span class="menu-icon">⚙️</span>
                    <span class="menu-text">설정</span>
                </div>

                <div class="menu-item" data-menu="mapping">
                    <span class="menu-icon">🎨</span> <!-- 아이콘은 자유롭게 변경 -->
                    <span class="menu-text">감정 매핑 관리</span>
                </div>

            </nav>
        </aside>

        <!-- 메인 콘텐츠 -->
        <main class="main-content">
            <!-- 헤더 -->
            <header class="admin-header">
                <div class="header-left">
                    <h1 id="page-title">대시보드</h1>
                    <p id="page-subtitle">전체 현황을 확인하세요</p>
                </div>
                <div class="header-right">
                    <div class="user-info">
                        <span class="user-name">관리자</span>
                        <div class="user-avatar">👤</div>
                    </div>
                </div>
            </header>

            <!-- 대시보드 섹션 -->
            <section class="content-section" id="dashboard-section">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">👥</div>
                        <div class="stat-info">
                            <h3>총 회원수</h3>
                            <p class="stat-number"
                               th:text="${#numbers.formatInteger(memberCount, 0, 'COMMA')}">1,245</p>
                            <span class="stat-change positive" th:if="${memberMoM != null}"
                                  th:text="${memberMoM}">+12% 이번 달</span>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-icon">🤝</div>
                        <div class="stat-info">
                            <h3>매칭 성사</h3>
                            <p class="stat-number"
                               th:text="${#numbers.formatInteger(matchingCount, 0, 'COMMA')}">456</p>
                            <span class="stat-change positive" th:if="${matchingMoM != null}"
                                  th:text="${matchingMoM}">+8% 이번 달</span>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-icon">📍</div>
                        <div class="stat-info">
                            <h3>등록 관광지</h3>
                            <p class="stat-number"
                               th:text="${#numbers.formatInteger(attractionCount, 0, 'COMMA')}">89</p>
                            <span class="stat-change neutral" th:if="${attractionDelta != null}"
                                  th:text="${attractionDelta}">변동 없음</span>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-icon">⚠️</div>
                        <div class="stat-info">
                            <h3>미처리 신고</h3>
                            <p class="stat-number"
                               th:text="${#numbers.formatInteger(unresolvedReportCount, 0, 'COMMA')}">3</p>
                            <span class="stat-change negative" th:if="${unresolvedHint != null}"
                                  th:text="${unresolvedHint}">처리 필요</span>
                        </div>
                    </div>
                </div>


                <!-- 차트 영역 -->
                <div class="charts-grid">
                    <div class="chart-container">
                        <h3>월별 회원 가입 현황</h3>
                        <canvas id="userChart"></canvas>
                    </div>
                    <div class="chart-container">
                        <h3>감정 태그별 검색 빈도</h3>
                        <canvas id="emotionChart"></canvas>
                    </div>
                </div>

                <!-- 최근 활동 -->
                <div class="recent-activity">
                    <h3>최근 활동</h3>
                    <div class="activity-list">
                        <div class="activity-item">
                            <span class="activity-time">10분 전</span>
                            <span class="activity-text">새로운 회원이 가입했습니다 (홍길동님)</span>
                        </div>
                        <div class="activity-item">
                            <span class="activity-time">1시간 전</span>
                            <span class="activity-text">부산 여행 매칭방이 생성되었습니다</span>
                        </div>
                        <div class="activity-item">
                            <span class="activity-time">2시간 전</span>
                            <span class="activity-text">신고가 접수되었습니다 (매칭방 내 부적절한 언어)</span>
                        </div>
                    </div>
                </div>
            </section>

            <!-- 회원 관리 섹션 -->
            <section class="content-section" id="users-section" style="display: none;">
                <div class="section-header">
                    <h2>회원 관리</h2>
                    <div class="section-actions">
                        <input type="text" placeholder="회원ID, 닉네임, 이메일로 검색..." class="search-input" id="member-search-input">
                        <button class="btn-primary" onclick="searchMembers()">검색</button>
                    </div>
                </div>



                <!-- 필터 버튼 -->
                <div class="filter-section" style="margin-bottom: 15px;">
                    <div class="filter-buttons">
                        <button class="filter-btn active" onclick="filterMembersByStatus('ALL')">전체</button>
                        <button class="filter-btn" onclick="filterMembersByStatus('ACTIVE')">활성</button>
                        <button class="filter-btn" onclick="filterMembersByStatus('SUSPENDED')">정지</button>
                        <button class="filter-btn" onclick="filterMembersByStatus('WITHDRAWN')">탈퇴</button>
                        <button class="filter-btn" onclick="filterMembersByStatus('REPORTED')">신고다수</button>
                    </div>
                </div>

                <div class="table-container">
                    <table class="data-table">
                        <thead>
                        <tr>
                            <th>회원ID</th>
                            <th>닉네임</th>
                            <th>이메일</th>
                            <th>가입일</th>
                            <th>매칭참여</th>
<!--                            <th>신고받음</th>-->
                            <th>상태</th>
                            <th>관리</th>
                        </tr>
                        </thead>
                        <tbody id="members-table-body">
                        <!-- 타임리프로 회원 목록 표시 -->
                        <tr th:each="member : ${members}"
                            th:data-member-pk="${member.memberPk}"
                            th:data-status="${member.status}"
                            th:data-is-withdraw="${member.isWithdraw}"
                            th:data-rpt-count="${member.rptRcvdCnt ?: 0}">
                            <td th:text="${member.memberId}">회원ID</td>
                            <td>
                                <span th:text="${member.nickname}">닉네임</span>
                                <!-- 소셜 로그인 표시 -->
                                <span th:if="${member.provider}"
                                      th:class="'social-badge ' + ${#strings.toLowerCase(member.provider)}"
                                      th:text="${member.provider}"
                                      style="font-size: 10px; padding: 2px 6px; border-radius: 4px; margin-left: 5px; background: #e5e7eb; color: #374151;">
                                    </span>
                            </td>
                            <td th:text="${member.email ?: '-'}">이메일</td>
                            <td th:text="${#temporals.format(member.createdAt, 'yyyy-MM-dd')}">가입일</td>
                            <td>
                                <span th:text="${member.matchingParticipationCount ?: 0} + '회'">0회</span>
                            </td>

                            <td>
                                <span th:class="${member.statusClass}" th:text="${member.statusDisplay}">활성</span>
                            </td>
                            <td>
                                <button class="btn-small" onclick="handleUserDetail(this)">상세</button>
                                <!-- 탈퇴하지 않은 회원만 상태 변경/탈퇴 버튼 표시 -->
                                <th:block th:if="${!member.isWithdraw}">
                                    <button th:class="${member.status == 'ACTIVE' ? 'btn-small danger' : 'btn-small success'}"
                                            th:onclick="'handleUserStatusChange(this, \'' + ${member.memberPk} + '\')'"
                                            th:text="${member.status == 'ACTIVE' ? '정지' : '활성화'}">
                                        정지
                                    </button>
                                    <button class="btn-small danger"
                                            th:onclick="'handleUserWithdraw(this, \'' + ${member.memberPk} + '\')'">
                                        탈퇴
                                    </button>
                                </th:block>
                                <!-- 탈퇴한 회원은 탈퇴 표시만 -->
                                <th:block th:if="${member.isWithdraw}">
                                    <span style="color: #666; font-size: 12px;">탈퇴 처리됨</span>
                                </th:block>
                            </td>
                        </tr>

                        <!-- 회원이 없을 때 -->
                        <tr th:if="${#lists.isEmpty(members)}" id="no-members-row">
                            <td colspan="8" style="text-align: center; padding: 40px; color: #666;">
                                등록된 회원이 없습니다.
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>

                <!-- 테이블 하단 정보 -->
                <div class="table-footer" style="margin-top: 15px; display: flex; justify-content: space-between; align-items: center; color: #666; font-size: 14px;">
                    <div class="table-info">
                        총<span th:text="${members != null ? #lists.size(members) : 0}">0</span>명의 회원
                        (<span th:text="${members != null ? #lists.size(members) : 0}">0</span>명 표시 중)
                    </div>
                    <div class="table-actions">
                        <button class="btn-small" onclick="exportMemberList()">목록 내보내기</button>
                    </div>
                </div>

                <!-- 페이지네이션 -->
                <div class="pagination-container" style="margin-top: 20px; text-align: center;">


                </div>
            </section>

            <!-- 관광지 관리 섹션 (Thymeleaf 서버렌더) -->
            <section class="content-section" id="locations-section" style="display: none;">
                <div class="section-header">
                    <h2>관광지 관리</h2>
                    <div class="section-actions">
                        <!-- admin.js 의 검색 로직이 .search-input 클래스에 바인딩됨 -->
                        <input type="text" class="search-input" placeholder="관광지명 / 지역 / 태그 검색..." />
                        <button class="btn-primary" onclick="showLocationForm()">새 관광지 추가</button>
                    </div>
                </div>

                <!-- 목록 뷰 -->
                <div id="location-list-view">
                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                            <tr>
                                <th>관광지명</th>
                                <th>지역</th>
                                <th>카테고리</th>
                                <th>감정태그</th>
                                <th>등록일</th>
                                <th>상태</th>
                                <th>관리</th>
                            </tr>
                            </thead>
                            <tbody id="attractions-table-body">
                            <!-- 서버가 내려주는 attractions 리스트 렌더 -->
                            <tr th:each="a : ${attractions}" th:data-attraction-id="${a.attractionId}">
                                <td th:text="${a.title}">관광지명</td>
                                <td th:text="${a.addr1}">지역</td>
                                <td th:text="${a.categoryName}">카테고리</td>
                                <td th:text="${a.emotionTags != null && !#strings.isEmpty(a.emotionTags) ? a.emotionTags : '-'}">감정태그</td>
                                <td th:text="${#temporals.format(a.createdTime, 'yyyy-MM-dd')}">등록일</td>
                                <td>
                                    <!-- statusClass 예: 'status active' / 'status suspended' / 'status pending' -->
                                    <span th:class="${a.statusClass}" th:text="${a.status}">공개</span>
                                </td>
                                <td>
                                    <!-- admin.js 에 구현된 핸들러와 이름을 정확히 맞춤 -->
                                    <button class="btn-small" onclick="handleLocationDetail(this)">상세</button>
                                    <button class="btn-small" onclick="handleLocationEditFromList(this)">수정</button>
                                    <button class="btn-small danger" onclick="handleLocationDeleteFromList(this)">삭제</button>
                                </td>
                            </tr>

                            <!-- 데이터 없을 때 -->
                            <tr th:if="${#lists.isEmpty(attractions)}">
                                <td colspan="7" style="text-align:center; padding:40px; color:#666;">
                                    등록된 관광지가 없습니다.
                                </td>
                            </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- (선택) 페이지네이션 영역: 필요 시 서버/클라 방식 중 택1로 구성 -->
                    <div class="pagination-container" style="margin-top: 20px; text-align: center;">
                        <!-- 서버 페이징을 쓰면 Thymeleaf로 버튼 렌더,
                             클라 페이징을 쓰면 admin.js 의 setupAttractionsPagination 활용 -->
                    </div>
                </div>

                <!-- 폼 뷰 (신규/수정 공용) -->
                <div id="location-form-view" style="display:none;">
                    <div class="form-row">
                        <div class="form-group">
                            <label>관광지명</label>
                            <input type="text" id="location-name" />
                        </div>
                        <div class="form-group">
                            <label>지역</label>
                            <select id="location-region">
                                <option>서울</option><option>부산</option><option>제주</option><option>경기</option>
                                <option>강원</option><option>경남</option><option>전남</option><option>충남</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>카테고리</label>
                            <select id="location-category">
                                <option>역사/문화</option><option>자연/휴양</option>
                                <option>체험/액티비티</option><option>맛집/쇼핑</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>감정태그</label>
                            <input type="text" id="location-tags" placeholder="쉼표로 구분" />
                        </div>
                    </div>

                    <div class="form-group">
                        <label>설명</label>
                        <textarea id="location-description" rows="4"></textarea>
                    </div>

                    <div class="modal-actions">
                        <button class="btn-secondary" onclick="cancelLocationForm()">취소</button>
                        <button class="btn-primary" onclick="saveLocation()">저장</button>
                    </div>
                </div>
            </section>

            <!---매칭 관리 섹션--->
            <section class="content-section" id="matching-section">
                <div class="section-header">
                    <h2>매칭 관리</h2>
                    <div class="filter-buttons">
                        <button class="filter-btn active">전체</button>
                        <button class="filter-btn">진행중</button>
                        <button class="filter-btn">완료</button>
                        <button class="filter-btn">취소</button>
                    </div>
                </div>

                <div class="matching-grid">
                    <div class="matching-card" th:each="matching : ${matchings}"
                         th:data-room-id="${matching.roomId}"
                         th:data-created-at="${matching.createdAt}">
                        <div class="matching-header">
                            <h4 th:text="${matching.roomName}">방 이름</h4>
                            <span class="matching-status"
                                  th:classappend="${matching.status == '진행중'} ? ' active' :
                                      (${matching.status == '완료'} ? ' completed' : ' cancelled')"
                                  th:text="${matching.status}">
                    진행중
                </span>
                        </div>
                        <div class="matching-info">
                            <p><strong>생성자:</strong> <span th:text="${matching.creatorNickname}">홍길동</span></p>
                            <p><strong>참여자:</strong>
                                <span th:text="${matching.currentCount}">2</span> /
                                <span th:text="${matching.maxCount}">4</span>명
                            </p>
                            <p><strong>여행일:</strong>
                                <span th:text="${matching.travelStartDate}">2025-08-05</span> ~
                                <span th:text="${matching.travelEndDate}">2025-08-08</span>
                            </p>
                            <p><strong>여행기간:</strong>
                                <span th:text="${matching.travelPeriod}"></span>일
                            </p>
                            <p><strong>지역:</strong> <span th:text="${matching.regionName}">강원</span></p>
                            <p><strong>관광지:</strong> <span th:text="${matching.attractionTitle}">춘천연극제</span></p>
                        </div>
                        <div class="matching-actions">
                            <button class="btn-small" onclick="handleMatchingDetail(this)">상세보기</button>
                            <button class="btn-small danger" onclick="handleMatchingTerminate(this)"
                                    th:if="${matching.status == '진행중'}">강제종료</button>
                        </div>
                    </div>
                </div>
                <div class="pagination-container" style="margin-top: 20px; text-align: center;">

                </div>
            </section>


<!--            &lt;!&ndash; 관광지 관리 섹션 &ndash;&gt;-->
<!--            <section class="content-section" id="locations-section" style="display: none;">-->
<!--&lt;!&ndash;                <tbody id="attractions-table-body">&ndash;&gt;-->
<!--&lt;!&ndash;                <th:block th:each="attraction : ${attractions}">&ndash;&gt;-->
<!--&lt;!&ndash;                    <tr th:data-attraction-id="${attraction.attractionId}">&ndash;&gt;-->
<!--&lt;!&ndash;                        <td th:text="${attraction.title}">관광지명</td>&ndash;&gt;-->
<!--&lt;!&ndash;                        <td th:text="${attraction.addr1}">지역</td>&ndash;&gt;-->
<!--&lt;!&ndash;                        <td th:text="${attraction.categoryName}">카테고리</td>&ndash;&gt;-->
<!--&lt;!&ndash;                        <td th:text="${attraction.emotionTags}">감정태그</td>&ndash;&gt;-->
<!--&lt;!&ndash;                        <td th:text="${#temporals.format(attraction.createdTime, 'yyyy-MM-dd')}">등록일</td>&ndash;&gt;-->
<!--&lt;!&ndash;                        <td>&ndash;&gt;-->
<!--&lt;!&ndash;                <span th:class="${attraction.statusClass}"&ndash;&gt;-->
<!--&lt;!&ndash;                      th:text="${attraction.status}">상태</span>&ndash;&gt;-->
<!--&lt;!&ndash;                        </td>&ndash;&gt;-->
<!--&lt;!&ndash;                        <td>&ndash;&gt;-->
<!--&lt;!&ndash;                            <button class="btn-small" onclick="handleLocationDetail(this)">상세</button>&ndash;&gt;-->
<!--&lt;!&ndash;                            <button class="btn-small" onclick="handleLocationEdit(this)">수정</button>&ndash;&gt;-->
<!--&lt;!&ndash;                            <button class="btn-small danger" onclick="handleLocationDelete(this)">삭제</button>&ndash;&gt;-->
<!--&lt;!&ndash;                        </td>&ndash;&gt;-->
<!--&lt;!&ndash;                    </tr>&ndash;&gt;-->
<!--&lt;!&ndash;                </th:block>&ndash;&gt;-->

<!--&lt;!&ndash;                &lt;!&ndash; 데이터 없을 때 &ndash;&gt;&ndash;&gt;-->
<!--&lt;!&ndash;                <tr th:if="${#lists.isEmpty(attractions)}">&ndash;&gt;-->
<!--&lt;!&ndash;                    <td colspan="7" style="text-align: center; padding: 40px; color: #666;">&ndash;&gt;-->
<!--&lt;!&ndash;                        등록된 관광지가 없습니다.&ndash;&gt;-->
<!--&lt;!&ndash;                    </td>&ndash;&gt;-->
<!--&lt;!&ndash;                </tr>&ndash;&gt;-->
<!--&lt;!&ndash;                </tbody>&ndash;&gt;-->

<!--                &lt;!&ndash; 관광지 목록 &ndash;&gt;-->
<!--                <div class="section-header">-->
<!--                    <h2>관광지 관리</h2>-->
<!--                    <button class="btn-primary" onclick="showLocationForm()">새 관광지 추가</button>-->
<!--                </div>-->

<!--                &lt;!&ndash; 관광지 목록 &ndash;&gt;-->
<!--                <div id="location-list-view">-->
<!--                    <div class="table-container">-->
<!--                        <table class="data-table">-->
<!--                            <thead>-->
<!--                                <tr>-->
<!--                                    <th>관광지명</th>-->
<!--                                    <th>지역</th>-->
<!--                                    <th>카테고리</th>-->
<!--                                    <th>감정태그</th>-->
<!--                                    <th>등록일</th>-->
<!--                                    <th>상태</th>-->
<!--                                    <th>관리</th>-->
<!--                                </tr>-->
<!--                            </thead>-->
<!--                            <tbody>-->
<!--                                <tr>-->
<!--                                    <td>경복궁</td>-->
<!--                                    <td>서울</td>-->
<!--                                    <td>역사/문화</td>-->
<!--                                    <td>감동, 힐링</td>-->
<!--                                    <td>2024-06-01</td>-->
<!--                                    <td><span class="status active">공개</span></td>-->
<!--                                    <td>-->
<!--                                        <button class="btn-small" onclick="handleLocationDetail(this)">상세</button>-->
<!--                                        <button class="btn-small" onclick="handleLocationEditFromList(this)">수정</button>-->
<!--                                        <button class="btn-small danger" onclick="handleLocationDeleteFromList(this)">삭제</button>-->
<!--                                    </td>-->
<!--                                </tr>-->
<!--                                <tr>-->
<!--                                    <td>해운대 해수욕장</td>-->
<!--                                    <td>부산</td>-->
<!--                                    <td>자연/휴양</td>-->
<!--                                    <td>휴식, 자연</td>-->
<!--                                    <td>2024-06-01</td>-->
<!--                                    <td><span class="status active">공개</span></td>-->
<!--                                    <td>-->
<!--                                        <button class="btn-small" onclick="handleLocationDetail(this)">상세</button>-->
<!--                                        <button class="btn-small" onclick="handleLocationEditFromList(this)">수정</button>-->
<!--                                        <button class="btn-small danger" onclick="handleLocationDeleteFromList(this)">삭제</button>-->
<!--                                    </td>-->
<!--                                </tr>-->
<!--                                <tr>-->
<!--                                    <td>제주 성산일출봉</td>-->
<!--                                    <td>제주</td>-->
<!--                                    <td>자연/휴양</td>-->
<!--                                    <td>모험, 자연, 감동</td>-->
<!--                                    <td>2024-05-15</td>-->
<!--                                    <td><span class="status active">공개</span></td>-->
<!--                                    <td>-->
<!--                                        <button class="btn-small" onclick="handleLocationDetail(this)">상세</button>-->
<!--                                        <button class="btn-small" onclick="handleLocationEditFromList(this)">수정</button>-->
<!--                                        <button class="btn-small danger" onclick="handleLocationDeleteFromList(this)">삭제</button>-->
<!--                                    </td>-->
<!--                                </tr>-->
<!--                                <tr>-->
<!--                                    <td>남산타워</td>-->
<!--                                    <td>서울</td>-->
<!--                                    <td>체험/액티비티</td>-->
<!--                                    <td>로맨틱, 전망</td>-->
<!--                                    <td>2024-05-20</td>-->
<!--                                    <td><span class="status pending">검토중</span></td>-->
<!--                                    <td>-->
<!--                                        <button class="btn-small" onclick="handleLocationDetail(this)">상세</button>-->
<!--                                        <button class="btn-small" onclick="handleLocationEditFromList(this)">수정</button>-->
<!--                                        <button class="btn-small danger" onclick="handleLocationDeleteFromList(this)">삭제</button>-->
<!--                                    </td>-->
<!--                                </tr>-->
<!--                                <tr>-->
<!--                                    <td>광안대교</td>-->
<!--                                    <td>부산</td>-->
<!--                                    <td>자연/휴양</td>-->
<!--                                    <td>야경, 로맨틱</td>-->
<!--                                    <td>2024-04-10</td>-->
<!--                                    <td><span class="status suspended">비공개</span></td>-->
<!--                                    <td>-->
<!--                                        <button class="btn-small" onclick="handleLocationDetail(this)">상세</button>-->
<!--                                        <button class="btn-small" onclick="handleLocationEditFromList(this)">수정</button>-->
<!--                                        <button class="btn-small danger" onclick="handleLocationDeleteFromList(this)">삭제</button>-->
<!--                                    </td>-->
<!--                                </tr>-->
<!--                            </tbody>-->
<!--                        </table>-->
<!--                    </div>-->
<!--                </div>-->

<!--                &lt;!&ndash; 관광지 추가/수정 폼 &ndash;&gt;-->
<!--                <div class="location-form" id="location-form-view" style="display: none;">-->
<!--                    <div class="form-row">-->
<!--                        <div class="form-group">-->
<!--                            <label>관광지명</label>-->
<!--                            <input type="text" id="location-name" placeholder="관광지명을 입력하세요">-->
<!--                        </div>-->
<!--                        <div class="form-group">-->
<!--                            <label>지역</label>-->
<!--                            <select id="location-region">-->
<!--                                <option>서울</option>-->
<!--                                <option>부산</option>-->
<!--                                <option>제주</option>-->
<!--                                <option>경기</option>-->
<!--                            </select>-->
<!--                        </div>-->
<!--                    </div>-->
<!--                    <div class="form-row">-->
<!--                        <div class="form-group">-->
<!--                            <label>카테고리</label>-->
<!--                            <select id="location-category">-->
<!--                                <option>역사/문화</option>-->
<!--                                <option>자연/휴양</option>-->
<!--                                <option>체험/액티비티</option>-->
<!--                                <option>맛집/쇼핑</option>-->
<!--                            </select>-->
<!--                        </div>-->
<!--                        <div class="form-group">-->
<!--                            <label>감정태그</label>-->
<!--                            <input type="text" id="location-tags" placeholder="관련 감정태그를 입력하세요">-->
<!--                        </div>-->
<!--                    </div>-->
<!--                    <div class="form-group">-->
<!--                        <label>설명</label>-->
<!--                        <textarea id="location-description" placeholder="관광지에 대한 설명을 입력하세요"></textarea>-->
<!--                    </div>-->
<!--                    <div class="form-actions">-->
<!--                        <button class="btn-primary" onclick="saveLocation()">저장</button>-->
<!--                        <button class="btn-secondary" onclick="cancelLocationForm()">취소</button>-->
<!--                    </div>-->
<!--                </div>-->
<!--            </section>-->

<!--            &lt;!&ndash; 신고 관리 섹션 &ndash;&gt;-->
<!--            <section class="content-section" id="reports-section" style="display: none;">-->
<!--                <div class="section-header">-->
<!--                    <h2>신고 관리</h2>-->
<!--                    <div class="filter-buttons">-->
<!--                        <button class="filter-btn active">전체</button>-->
<!--                        <button class="filter-btn">미처리</button>-->
<!--                        <button class="filter-btn">처리완료</button>-->
<!--                    </div>-->
<!--                </div>-->
<!--                -->
<!--                <div class="reports-list">-->
<!--                    <div class="report-item urgent">-->
<!--                        <div class="report-header">-->
<!--                            <h4>부적절한 언어 사용</h4>-->
<!--                            <span class="report-status pending">미처리</span>-->
<!--                        </div>-->
<!--                        <div class="report-info">-->
<!--                            <p><strong>신고자:</strong> 김영희</p>-->
<!--                            <p><strong>피신고자:</strong> 박철수</p>-->
<!--                            <p><strong>신고일:</strong> 2024-07-01 14:30</p>-->
<!--                            <p><strong>내용:</strong> 채팅방에서 욕설 및 성희롱 발언</p>-->
<!--                        </div>-->
<!--                        <div class="report-actions">-->
<!--                            <button class="btn-small" onclick="handleReportDetail(this)">상세보기</button>-->
<!--                            <button class="btn-small warning" onclick="handleReportWarning(this)">경고</button>-->
<!--                            <button class="btn-small danger" onclick="handleReportSuspension(this)">계정정지</button>-->
<!--                        </div>-->
<!--                    </div>-->
<!--                    -->
<!--                    <div class="report-item">-->
<!--                        <div class="report-header">-->
<!--                            <h4>스팸성 게시물</h4>-->
<!--                            <span class="report-status resolved">처리완료</span>-->
<!--                        </div>-->
<!--                        <div class="report-info">-->
<!--                            <p><strong>신고자:</strong> 이민수</p>-->
<!--                            <p><strong>피신고자:</strong> 광고계정1</p>-->
<!--                            <p><strong>신고일:</strong> 2024-06-30 09:15</p>-->
<!--                            <p><strong>처리결과:</strong> 계정 삭제 처리</p>-->
<!--                        </div>-->
<!--                        <div class="report-actions">-->
<!--                            <button class="btn-small" onclick="handleReportDetail(this)">상세보기</button>-->
<!--                        </div>-->
<!--                    </div>-->
<!--                    -->
<!--                    <div class="report-item">-->
<!--                        <div class="report-header">-->
<!--                            <h4>허위 정보 유포</h4>-->
<!--                            <span class="report-status pending">미처리</span>-->
<!--                        </div>-->
<!--                        <div class="report-info">-->
<!--                            <p><strong>신고자:</strong> 정수진</p>-->
<!--                            <p><strong>피신고자:</strong> 최민호</p>-->
<!--                            <p><strong>신고일:</strong> 2024-07-02 11:20</p>-->
<!--                            <p><strong>내용:</strong> 관광지에 대한 거짓 정보 게시</p>-->
<!--                        </div>-->
<!--                        <div class="report-actions">-->
<!--                            <button class="btn-small" onclick="handleReportDetail(this)">상세보기</button>-->
<!--                            <button class="btn-small warning" onclick="handleReportWarning(this)">경고</button>-->
<!--                            <button class="btn-small danger" onclick="handleReportSuspension(this)">계정정지</button>-->
<!--                        </div>-->
<!--                    </div>-->
<!--                    -->
<!--                    <div class="report-item">-->
<!--                        <div class="report-header">-->
<!--                            <h4>사기 행위</h4>-->
<!--                            <span class="report-status warning-issued">경고처리</span>-->
<!--                        </div>-->
<!--                        <div class="report-info">-->
<!--                            <p><strong>신고자:</strong> 한지민</p>-->
<!--                            <p><strong>피신고자:</strong> 이상훈</p>-->
<!--                            <p><strong>신고일:</strong> 2024-06-28 16:45</p>-->
<!--                            <p><strong>내용:</strong> 가짜 여행 상품 판매 시도</p>-->
<!--                        </div>-->
<!--                        <div class="report-actions">-->
<!--                            <button class="btn-small" onclick="handleReportDetail(this)">상세보기</button>-->
<!--                            <button class="btn-small success" onclick="handleReportCancel(this)">처리취소</button>-->
<!--                        </div>-->
<!--                    </div>-->
<!--                    -->
<!--                    <div class="report-item urgent">-->
<!--                        <div class="report-header">-->
<!--                            <h4>괴롭힘 및 혐오 발언</h4>-->
<!--                            <span class="report-status suspended">계정정지</span>-->
<!--                        </div>-->
<!--                        <div class="report-info">-->
<!--                            <p><strong>신고자:</strong> 윤서연</p>-->
<!--                            <p><strong>피신고자:</strong> 강동욱</p>-->
<!--                            <p><strong>신고일:</strong> 2024-06-25 19:30</p>-->
<!--                            <p><strong>내용:</strong> 지속적인 괴롭힘 및 차별적 발언</p>-->
<!--                        </div>-->
<!--                        <div class="report-actions">-->
<!--                            <button class="btn-small" onclick="handleReportDetail(this)">상세보기</button>-->
<!--                            <button class="btn-small success" onclick="handleReportCancel(this)">처리취소</button>-->
<!--                        </div>-->
<!--                    </div>-->
<!--                </div>-->
<!--            </section>-->
            <!-- 신고 관리 섹션 타임리프 적용-->
            <section class="content-section" id="reports-section" style="display: none;">
                <div class="section-header">
                    <h2>신고 관리</h2>
                    <div class="section-actions">
                        <div class="filter-buttons">
                            <!-- admin.js의 applyFilter는 버튼 텍스트로 필터함: '전체' | '대기' | '처리완료' | '거부' -->
                            <button class="filter-btn active">전체</button>
                            <button class="filter-btn">대기</button>
                            <button class="filter-btn">처리완료</button>
                            <button class="filter-btn">거부</button>
                        </div>
                    </div>
                </div>

                <div class="table-container">
                    <table class="data-table">
                        <thead>
                        <tr>
                            <th>신고ID</th>
                            <th>유형</th>
                            <th>대상</th>
                            <th>신고자</th>
                            <th>피신고자</th>
                            <th>사유</th>
                            <th>일시</th>
                            <th>상태</th>
                            <th>관리</th>
                        </tr>
                        </thead>
                        <tbody id="reports-table-body">
                        <!-- 서버가 내려주는 reports 리스트 -->
                        <tr th:each="r : ${reports}" class="report-item"
                            th:data-report-id="${r.reportId}"
                            th:data-type="${r.type}">
                            <td th:text="${r.reportId}">1</td>
                            <td th:text="${r.typeDisplay}">매칭방</td>
                            <td th:text="${r.targetSummary}">부산 힐링 여행(ROOM#123)</td>
                            <td th:text="${r.reporterNickname}">신고자닉</td>
                            <td th:text="${r.reportedNickname}">피신고자닉</td>
                            <td th:text="${r.reason}">욕설/비방</td>
                            <td th:text="${#temporals.format(r.createdAt, 'yyyy-MM-dd HH:mm')}">2025-08-28 10:32</td>
                            <td>
                                <!-- statusClass: 'status pending' | 'status active' | 'status suspended' 등, 텍스트는 '대기' | '처리완료' | '거부' -->
                                <span class="report-status"
                                      th:classappend="${' ' + r.statusClass}"
                                      th:text="${r.statusDisplay}">대기</span>
                            </td>
                            <td>
                                <!-- 아래 핸들러 이름은 admin.js에 맞춰 쓰면 바로 연결 가능.
                                     아직 없다면 추후 같은 이름으로 구현하면 됨. -->
                                <button class="btn-small" onclick="handleReportDetail(this)">상세</button>
                                <button class="btn-small success" onclick="handleReportResolve(this)">처리완료</button>
                                <button class="btn-small danger" onclick="handleReportReject(this)">거부</button>
                                <button class="btn-small danger" onclick="handleReportDelete(this)">삭제</button>
                            </td>
                        </tr>

                        <!-- 데이터 없을 때 -->
                        <tr th:if="${#lists.isEmpty(reports)}">
                            <td colspan="9" style="text-align:center; padding:40px; color:#666;">
                                접수된 신고가 없습니다.
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>

<!--                &lt;!&ndash; 페이지네이션 &ndash;&gt;-->
<!--                <div class="pagination-container" style="margin-top:20px; text-align:center;">-->
<!--                    <div class="pagination" th:if="${page != null}">-->
<!--                        &lt;!&ndash; 이전 &ndash;&gt;-->
<!--                        <a th:href="@{|/admin/reports?page=${page.number - 1}&size=${size}|}"-->
<!--                           th:classappend="${page.first} ? ' disabled'">&laquo; 이전</a>-->

<!--                        &lt;!&ndash; 번호 &ndash;&gt;-->
<!--                        <span th:each="i : ${#numbers.sequence(0, page.totalPages - 1)}">-->
<!--        <a th:href="@{|/admin/reports?page=${i}&size=${size}|}"-->
<!--           th:text="${i + 1}"-->
<!--           th:classappend="${i == page.number} ? ' active'"></a>-->
<!--      </span>-->

<!--                        &lt;!&ndash; 다음 &ndash;&gt;-->
<!--                        <a th:href="@{|/admin/reports?page=${page.number + 1}&size=${size}|}"-->
<!--                           th:classappend="${page.last} ? ' disabled'">다음 &raquo;</a>-->
<!--                    </div>-->

<!--                    <div style="margin-top:8px; color:#666; font-size:13px;" th:if="${page != null}">-->
<!--                        총 <span th:text="${page.totalElements}">0</span>건 /-->
<!--                        <span th:text="${page.number + 1}">1</span> /-->
<!--                        <span th:text="${page.totalPages}">1</span> 페이지-->
<!--                    </div>-->
<!--                </div>-->
                <!-- 페이지네이션 -->
                <div class="pagination-container" style="margin-top:20px; text-align:center;">

                </div>


            </section>

            <!-- 공지사항 섹션 -->
            <section class="content-section" id="notices-section" style="display: none;">
                <div class="section-header">
                    <h2>공지사항 관리</h2>
                    <div class="section-actions">
                        <button class="btn-primary" onclick="showNoticeForm()">새 공지사항 작성</button>
                    </div>
                </div>
                
                <!-- 공지사항 목록 -->
                <div id="notice-list-view">
                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                            <tr>
                                <th>제목</th>
                                <th>분류</th>
                                <th>작성자</th>
                                <th>작성일</th>
                                <th>조회수</th>
                                <th>상태</th>
                                <th>관리</th>
                            </tr>
                            </thead>
                            <tbody>
                            <!-- 타임리프로 공지사항 목록 표시 -->
                            <tr th:each="notice : ${notices}" th:data-notice-id="${notice.noticeId}">
                                <td>
                                    <span th:if="${notice.isImportant}" class="priority-badge important">중요</span>
                                    <span th:text="${notice.title}">제목</span>
                                </td>
                                <td th:text="${notice.classification}">분류</td>
                                <td>관리자</td>
                                <td th:text="${notice.registeredDate}">작성일</td>
                                <td th:text="${notice.viewCount != null ? notice.viewCount : 0}">0</td>
                                <td>
            <span th:class="${notice.isVisible ? 'status active' : 'status suspended'}"
                  th:text="${notice.isVisible ? '공개' : '비공개'}">상태</span>
                                </td>
                                <td>
                                    <button class="btn-small" onclick="handleNoticeEdit(this)">수정</button>
                                    <button class="btn-small danger" onclick="handleNoticeDelete(this)">삭제</button>
                                </td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>


                <!-- 공지사항 작성 폼 -->
<!--                <div class="notice-form" id="notice-form-view" style="display: none;">-->
<!--                    <div class="form-group">-->
<!--                        <label>제목</label>-->
<!--                        <input type="text" id="notice-title" placeholder="공지사항 제목을 입력하세요">-->
<!--                    </div>-->
<!--                    <div class="form-row">-->
<!--                        <div class="form-group">-->
<!--                            <label>분류</label>-->
<!--                            <select id="notice-category">-->
<!--                                <option>일반공지</option>-->
<!--                                <option>긴급공지</option>-->
<!--                                <option>이벤트</option>-->
<!--                                <option>업데이트</option>-->
<!--                            </select>-->
<!--                        </div>-->
<!--                        <div class="form-group">-->
<!--                            <label>공개설정</label>-->
<!--                            <select id="notice-visibility">-->
<!--                                <option>즉시공개</option>-->
<!--                                <option>예약공개</option>-->
<!--                                <option>비공개</option>-->
<!--                            </select>-->
<!--                        </div>-->
<!--                    </div>-->
<!--                    <div class="form-group">-->
<!--                        <label>내용</label>-->
<!--                        <textarea id="notice-content" placeholder="공지사항 내용을 입력하세요" rows="6"></textarea>-->
<!--                    </div>-->
<!--                    <div class="form-actions">-->
<!--                        <button class="btn-primary" onclick="publishNotice()">발행</button>-->
<!--                        <button class="btn-secondary" onclick="draftNotice()">임시저장</button>-->
<!--                        <button class="btn-secondary" onclick="cancelNoticeForm()">취소</button>-->
<!--                    </div>-->
<!--                </div>-->

            </section>

            <!-- FAQ 관리 섹션 -->
            <section class="content-section" id="faq-section" style="display: none;">
                <div class="section-header">
                    <h2>FAQ 관리</h2>
                    <div class="section-actions">
                        <button class="btn-primary" onclick="showFaqForm()">새 FAQ 작성</button>
                    </div>
                </div>

                <!-- FAQ 목록 -->
                <div id="faq-list-view">
                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                            <tr>
                                <th>질문</th>
                                <th>카테고리</th>
                                <th>작성일</th>
                                <th>관리</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr th:each="faq : ${faqs}" th:data-faq-id="${faq.id}">
                                <td th:text="${faq.title}">질문</td>
                                <td th:text="${faq.category}">카테고리</td>
                                <td th:text="${faq.createdAt != null ? #temporals.format(faq.createdAt, 'yyyy-MM-dd') : ''}">작성일</td>
                                <td>
                                    <button class="btn-small" onclick="editFaq(this)">수정</button>
                                    <button class="btn-small danger" onclick="deleteFaq(this)">삭제</button>
                                </td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- FAQ 작성 폼 -->
                <div class="faq-form" id="faq-form-view" style="display: none;">
                    <div class="form-group">
                        <label>카테고리</label>
                        <select id="faq-category">
                            <option>서비스 소개</option>
                            <option>회원 정보</option>
                            <option>이용 방법</option>
                            <option>결제</option>
                            <option>취소·환불</option>
                            <option>분쟁·페널티</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>질문</label>
                        <input type="text" id="faq-question" placeholder="질문을 입력하세요">
                    </div>
                    <div class="form-group">
                        <label>답변</label>
                        <textarea id="faq-answer" placeholder="답변을 입력하세요" rows="5"></textarea>
                    </div>
                    <div class="form-actions">
                        <button class="btn-primary" onclick="saveFaq()">저장</button>
                        <button class="btn-secondary" onclick="cancelFaqForm()">취소</button>
                    </div>
                </div>
                <!-- 페이지네이션 -->
                <div class="pagination-container" style="margin-top:20px; text-align:center;">

                </div>
            </section>


            <!-- 설정 섹션 -->
            <section class="content-section" id="settings-section" style="display: none;">
                <div class="section-header">
                    <h2>시스템 설정</h2>
                </div>
                
                <div class="settings-grid">
                    <div class="setting-group">
                        <h3>일반 설정</h3>
                        <div class="setting-item">
                            <label>관리자 이메일</label>
                            <input type="email" value="admin@travel.com">
                        </div>
                    </div>

                    
                    <div class="setting-group">
                        <h3>보안 설정</h3>
                        <div class="setting-item">
                            <label>로그인 시도 제한</label>
                            <input type="number" value="5">
                        </div>
                        <div class="setting-item">
                            <label>세션 유지시간 (분)</label>
                            <input type="number" value="30">
                        </div>
                    </div>
                </div>
                
                <div class="form-actions">
                    <button class="btn-primary" onclick="saveSettings()">설정 저장</button>
                    <button class="btn-secondary" onclick="resetSettings()">초기화</button>
                </div>
            </section>


            <section class="content-section" id="mapping-section" style="display: none;">
                <!-- 이 안의 내용은 JavaScript에 의해 동적으로 채워집니다. -->
            </section>


        </main>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="/js/admin/admin.js"></script>
<th:block th:replace="~{fix/footer :: footer}"></th:block>
<script th:src="@{/js/fix/header.js}"></script>
<script th:src="@{/js/fix/header-after.js}"></script>
</body>
</html>